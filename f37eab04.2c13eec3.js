(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{103:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return c})),n.d(t,"metadata",(function(){return o})),n.d(t,"rightToc",(function(){return i})),n.d(t,"default",(function(){return b}));var a=n(3),r=n(7),s=(n(0),n(107)),c={id:"stacks",title:"Stacks"},o={unversionedId:"stacks",id:"version-0.8.x/stacks",isDocsHomePage:!1,title:"Stacks",description:"Ingress stack",source:"@site/versioned_docs/version-0.8.x/stacks.md",slug:"/stacks",permalink:"/vkpr-docs/docs/stacks",editUrl:"https://github.com/vertigobr/vkpr/edit/docs/versioned_docs/version-0.8.x/stacks.md",version:"0.8.x",sidebar:"version-0.8.x/docs",previous:{title:"Introduction",permalink:"/vkpr-docs/docs/"},next:{title:"Roadmap",permalink:"/vkpr-docs/docs/roadmap"}},i=[{value:"Ingress stack",id:"ingress-stack",children:[{value:"NGINX Ingress Controller",id:"nginx-ingress-controller",children:[]},{value:"ExternalDNS",id:"externaldns",children:[]}]},{value:"Logging stack",id:"logging-stack",children:[{value:"Loki",id:"loki",children:[]}]},{value:"Monitoring stack",id:"monitoring-stack",children:[{value:"Prometheus Stack",id:"prometheus-stack",children:[]},{value:"Jaeger",id:"jaeger",children:[]}]},{value:"Security stack",id:"security-stack",children:[{value:"Cert Manager",id:"cert-manager",children:[]},{value:"Vault",id:"vault",children:[]},{value:"KeyCloak",id:"keycloak",children:[]}]},{value:"Backup stack",id:"backup-stack",children:[{value:"Velero",id:"velero",children:[]}]}],l={rightToc:i};function b(e){var t=e.components,n=Object(r.a)(e,["components"]);return Object(s.b)("wrapper",Object(a.a)({},l,n,{components:t,mdxType:"MDXLayout"}),Object(s.b)("h2",{id:"ingress-stack"},"Ingress stack"),Object(s.b)("h3",{id:"nginx-ingress-controller"},"NGINX Ingress Controller"),Object(s.b)("p",null,Object(s.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/kubernetes/ingress-nginx"}),"ingress-nginx")," is an Ingress controller for Kubernetes using NGINX as a reverse proxy and load balancer."),Object(s.b)("p",null,"Ingress exposes HTTP and HTTPS routes from outside the cluster to services within the cluster. An Ingress resource supports exposing services and configuring TLS termination for each exposed host name."),Object(s.b)("h4",{id:"implementation"},"Implementation"),Object(s.b)("p",null,"By default the ",Object(s.b)("strong",{parentName:"p"},"NGINX Ingress Controller")," is enabled in ",Object(s.b)("em",{parentName:"p"},"VKPR")," installation. An example of configuration :"),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-yaml"}),"nginx-ingress:\n  enabled: true\n  controller:\n    publishService:\n      enabled: true\n    autoscaling:\n      enabled: true\n      minReplicas: 1\n      maxReplicas: 3\n")),Object(s.b)("p",null,"To see more configurations, access the ",Object(s.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/helm/charts/tree/master/stable/nginx-ingress#configuration"}),"documentation"),". "),Object(s.b)("h3",{id:"externaldns"},"ExternalDNS"),Object(s.b)("p",null,Object(s.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/kubernetes-sigs/external-dns"}),"ExternalDNS")," is a Kubernetes addon that configures public DNS servers with information about exposed Kubernetes services to make them discoverable."),Object(s.b)("p",null,"Inspired by ",Object(s.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/kubernetes/dns"}),"Kubernetes DNS"),", Kubernetes' cluster-internal DNS server, ExternalDNS makes Kubernetes resources discoverable via public DNS servers. Like KubeDNS, it retrieves a list of resources (Services, Ingresses, etc.) from the ",Object(s.b)("a",Object(a.a)({parentName:"p"},{href:"https://kubernetes.io/docs/concepts/overview/kubernetes-api/"}),"Kubernetes API")," to determine a desired list of DNS records. Unlike KubeDNS, however, it's not a DNS server itself, but merely configures other DNS providers accordingly\u2014e.g. ",Object(s.b)("a",Object(a.a)({parentName:"p"},{href:"https://aws.amazon.com/route53/"}),"AWS Route 53")," or ",Object(s.b)("a",Object(a.a)({parentName:"p"},{href:"https://cloud.google.com/dns/docs/"}),"Google Cloud DNS"),"."),Object(s.b)("h4",{id:"implementation-1"},"Implementation"),Object(s.b)("p",null,"By default the ",Object(s.b)("strong",{parentName:"p"},"ExternalDNS")," is disabled in ",Object(s.b)("em",{parentName:"p"},"VKPR")," installation. An example of configuration:"),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-yaml"}),'external-dns:\n  enabled: true\n  rbac:\n    create: true\n  sources:\n    - ingress\n    - service\n  provider: digitalocean\n  interval: "1m"\n')),Object(s.b)("p",null,"To see more configurations, access the ",Object(s.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/bitnami/charts/tree/master/bitnami/external-dns#parameters"}),"documentation"),". "),Object(s.b)("h2",{id:"logging-stack"},"Logging stack"),Object(s.b)("h3",{id:"loki"},"Loki"),Object(s.b)("p",null,Object(s.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/grafana/loki"}),"Loki")," is a horizontally-scalable, highly-available, multi-tenant log aggregation system inspired by ",Object(s.b)("a",Object(a.a)({parentName:"p"},{href:"https://prometheus.io/"}),"Prometheus"),". It is designed to be very cost effective and easy to operate. It does not index logs content, but rather a set of labels for each log stream."),Object(s.b)("h4",{id:"implementation-2"},"Implementation"),Object(s.b)("p",null,"By default the ",Object(s.b)("strong",{parentName:"p"},"Loki")," is enabled in ",Object(s.b)("em",{parentName:"p"},"VKPR")," installation. An example of configuration:"),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-yaml"}),"loki-stack:\n  enabled: true\n  grafana:\n    enabled: false\n")),Object(s.b)("p",null,"To see more configurations, access the ",Object(s.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/grafana/loki/tree/master/production/helm"}),"documentation"),"."),Object(s.b)("h2",{id:"monitoring-stack"},"Monitoring stack"),Object(s.b)("h3",{id:"prometheus-stack"},"Prometheus Stack"),Object(s.b)("p",null,Object(s.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/prometheus-community/helm-charts/tree/main/charts/kube-prometheus-stack"}),"Prometheus Stack")," a collection of Kubernetes manifests, ",Object(s.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/grafana/grafana"}),"Grafana")," dashboards, and ",Object(s.b)("a",Object(a.a)({parentName:"p"},{href:"https://prometheus.io/"}),"Prometheus")," rules combined with documentation and scripts to provide easy to operate end-to-end Kubernetes cluster monitoring with Prometheus using the Prometheus Operator."),Object(s.b)("h4",{id:"implementation-3"},"Implementation"),Object(s.b)("p",null,"By default the ",Object(s.b)("strong",{parentName:"p"},"Prometheus Operator")," is disabled in ",Object(s.b)("em",{parentName:"p"},"VKPR")," installation. An example of configuration:"),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-yaml"}),"kube-prometheus-stack:\n  enabled: true\n  prometheusOperator:\n    enabled: true\n    createCustomResource: false\n    cleanupCustomResource: false\n  prometheus:\n    enabled: true\n  alertmanager:\n    enabled: false\n  grafana:\n    enabled: true\n    sidecar:\n      datasources:\n        enabled: true\n    persistence:\n      enabled: false\n    ingress:\n      enabled: true\n      hosts:\n      - grafana.<DOMAIN>\n")),Object(s.b)("p",null,"To see more configurations, access the ",Object(s.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/prometheus-community/helm-charts/tree/main/charts/kube-prometheus-stack"}),"documentation"),"."),Object(s.b)("h3",{id:"jaeger"},"Jaeger"),Object(s.b)("p",null,Object(s.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/jaegertracing/jaeger"}),"Jaeger")," is a distributed tracing system released as open source. It is used for monitoring and troubleshooting microservices-based distributed systems."),Object(s.b)("h4",{id:"implementation-4"},"Implementation"),Object(s.b)("p",null,"By default the ",Object(s.b)("strong",{parentName:"p"},"Jaeger")," is disabled in ",Object(s.b)("em",{parentName:"p"},"VKPR")," installation. An example of configuration:"),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-yaml"}),"jaeger:\n  enabled: true\n  cassandra:\n    config:\n      max_heap_size: 1024M\n      heap_new_size: 256M\n      cluster_size: 1\n    persistence:\n      enabled: true\n    resources:\n      requests:\n        memory: 2048Mi\n        cpu: 0.4\n      limits:\n        memory: 2048Mi\n        cpu: 1.0\n  query:\n    ingress:\n      enabled: true\n      hosts:\n      - jaeger.<DOMAIN>\n")),Object(s.b)("p",null,"To see more configurations, access the ",Object(s.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/jaegertracing/helm-charts/tree/master/charts/jaeger"}),"documentation"),"."),Object(s.b)("h2",{id:"security-stack"},"Security stack"),Object(s.b)("h3",{id:"cert-manager"},"Cert Manager"),Object(s.b)("p",null,Object(s.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/jetstack/cert-manager"}),"cert-manager")," is a Kubernetes addon to automate the management and issuance of TLS certificates from various issuing sources."),Object(s.b)("p",null,"It will ensure certificates are valid and up to date periodically, and attempt to renew certificates at an appropriate time before expiry."),Object(s.b)("h4",{id:"implementation-5"},"Implementation"),Object(s.b)("p",null,"By default the ",Object(s.b)("strong",{parentName:"p"},"cert-manager")," is disabled in ",Object(s.b)("em",{parentName:"p"},"VKPR")," installation. An example of configuration:"),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-yaml"}),"cert-manager:\n  enabled: true\n  ingressShim:\n    defaultIssuerName: letsencrypt-production\n    defaultIssuerKind: ClusterIssuer\n    defaultIssuerGroup: cert-manager.io\n")),Object(s.b)("p",null,"To see more configurations, access the ",Object(s.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/jetstack/cert-manager/blob/master/deploy/charts/cert-manager/README.template.md#configuration"}),"documentation"),"."),Object(s.b)("h3",{id:"vault"},"Vault"),Object(s.b)("p",null,Object(s.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/hashicorp/vault"}),"Vault")," is a tool for securely accessing secrets. A secret is anything that you want to tightly control access to, such as API keys, passwords, certificates, and more. Vault provides a unified interface to any secret, while providing tight access control and recording a detailed audit log."),Object(s.b)("p",null,"A modern system requires access to a multitude of secrets: database credentials, API keys for external services, credentials for service-oriented architecture communication, etc. Understanding who is accessing what secrets is already very difficult and platform-specific. Adding on key rolling, secure storage, and detailed audit logs is almost impossible without a custom solution. "),Object(s.b)("h4",{id:"implementation-6"},"Implementation"),Object(s.b)("p",null,"By default the ",Object(s.b)("strong",{parentName:"p"},"Vault")," is disabled in ",Object(s.b)("em",{parentName:"p"},"VKPR")," installation. An example of configuration:"),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-yaml"}),"vault:\n  enabled: true\n  server:\n    ha:\n      enabled: true\n      raft:\n        enabled: true\n")),Object(s.b)("p",null,"To see more configurations, access the ",Object(s.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/hashicorp/vault-helm"}),"documentation"),"."),Object(s.b)("h3",{id:"keycloak"},"KeyCloak"),Object(s.b)("p",null,Object(s.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/keycloak/keycloak"}),"KeyCloak")," is an Open Source Identity and Access Management solution for modern Applications and Services."),Object(s.b)("h4",{id:"implementation-7"},"Implementation"),Object(s.b)("p",null,"By default the ",Object(s.b)("strong",{parentName:"p"},"KeyCloak")," is disabled in ",Object(s.b)("em",{parentName:"p"},"VKPR")," installation. An example of configuration:"),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-yaml"}),'keycloak:\n  enabled: true\n  rbac:\n    create: true\n  postgresql:\n    enabled: false\n  ingress:\n    enabled: true\n    annotations:\n      kubernetes.io/ingress.class: nginx\n    rules:\n      - host: keycloak.<DOMAIN>\n        paths: ["/"]\n  extraEnv: |\n    - name: KEYCLOAK_USER\n      value: admin\n    - name: KEYCLOAK_PASSWORD\n      value: vkpr1234\n')),Object(s.b)("p",null,"To view more configuration, access the ",Object(s.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/codecentric/helm-charts/tree/master/charts/keycloak#configuration"}),"documentation"),"."),Object(s.b)("h2",{id:"backup-stack"},"Backup stack"),Object(s.b)("h3",{id:"velero"},"Velero"),Object(s.b)("p",null,Object(s.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/vmware-tanzu/velero"}),"Velero")," gives you tools to back up and restore your Kubernetes cluster resources and persistent volumes."),Object(s.b)("h4",{id:"implementation-8"},"Implementation"),Object(s.b)("p",null,"By default ",Object(s.b)("strong",{parentName:"p"},"Velero")," is disabled in ",Object(s.b)("em",{parentName:"p"},"VKPR")," installation. An example of configuration:"),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-yaml"}),"velero:\n  enabled: true\n  initContainers: \n    - name: velero-plugin-for-aws\n      image: velero/velero-plugin-for-aws:v1.0.0\n      imagePullPolicy: IfNotPresent\n      volumeMounts:\n        - mountPath: /target\n          name: plugins\n")),Object(s.b)("p",null,"To see more configurations, access the ",Object(s.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/vmware-tanzu/helm-charts/tree/main/charts/velero"}),"documentation"),"."))}b.isMDXComponent=!0},107:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return d}));var a=n(0),r=n.n(a);function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},s=Object.keys(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=r.a.createContext({}),b=function(e){var t=r.a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=b(e.components);return r.a.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},m=r.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,s=e.originalType,c=e.parentName,l=i(e,["components","mdxType","originalType","parentName"]),u=b(n),m=a,d=u["".concat(c,".").concat(m)]||u[m]||p[m]||s;return n?r.a.createElement(d,o(o({ref:t},l),{},{components:n})):r.a.createElement(d,o({ref:t},l))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var s=n.length,c=new Array(s);c[0]=m;var o={};for(var i in t)hasOwnProperty.call(t,i)&&(o[i]=t[i]);o.originalType=e,o.mdxType="string"==typeof e?e:a,c[1]=o;for(var l=2;l<s;l++)c[l]=n[l];return r.a.createElement.apply(null,c)}return r.a.createElement.apply(null,n)}m.displayName="MDXCreateElement"}}]);