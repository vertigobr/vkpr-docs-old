(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{92:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return i})),n.d(t,"metadata",(function(){return o})),n.d(t,"rightToc",(function(){return s})),n.d(t,"default",(function(){return u}));var a=n(3),r=n(7),l=(n(0),n(95)),i={id:"basic-installation",title:"Basic installation"},o={unversionedId:"guides/local/basic-installation",id:"guides/local/basic-installation",isDocsHomePage:!1,title:"Basic installation",description:"This guide shows the VKPR basic installation in local k3d environment and some tools are prerequisites for run:",source:"@site/docs/guides/local/basic-installation.md",slug:"/guides/local/basic-installation",permalink:"/vkpr-docs/docs/next/guides/local/basic-installation",editUrl:"https://github.com/vertigobr/vkpr/edit/docs/docs/guides/local/basic-installation.md",version:"current",sidebar:"docs",previous:{title:"Quickstart",permalink:"/vkpr-docs/docs/next/quickstart"},next:{title:"Grafana with KeyCloak",permalink:"/vkpr-docs/docs/next/guides/local/grafana-with-keycloak"}},s=[{value:"Installation and setup VKPR",id:"installation-and-setup-vkpr",children:[{value:"Create cluster",id:"create-cluster",children:[]},{value:"Setup Helm",id:"setup-helm",children:[]},{value:"Installation VKPR",id:"installation-vkpr",children:[]},{value:"Access whoami app",id:"access-whoami-app",children:[]}]},{value:"Destroy environment",id:"destroy-environment",children:[{value:"Uninstall VKPR",id:"uninstall-vkpr",children:[]},{value:"Destroy cluster",id:"destroy-cluster",children:[]}]}],c={rightToc:s};function u(e){var t=e.components,n=Object(r.a)(e,["components"]);return Object(l.b)("wrapper",Object(a.a)({},c,n,{components:t,mdxType:"MDXLayout"}),Object(l.b)("p",null,"This guide shows the VKPR basic installation in local k3d environment and some tools are prerequisites for run:"),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},Object(l.b)("a",Object(a.a)({parentName:"li"},{href:"https://k3d.io/"}),"k3d")," >= 3.3.0"),Object(l.b)("li",{parentName:"ul"},Object(l.b)("a",Object(a.a)({parentName:"li"},{href:"https://helm.sh/docs/intro/install/#helm"}),"Helm")," >= 3.0.0")),Object(l.b)("h2",{id:"installation-and-setup-vkpr"},"Installation and setup VKPR"),Object(l.b)("h3",{id:"create-cluster"},"Create cluster"),Object(l.b)("p",null,"In the first part of the guide we will create a local Kubernetes cluster with k3d, run:"),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-shell"}),'k3d cluster create vkpr-local -p "8080:80@loadbalancer" -p "8443:443@loadbalancer" --k3s-server-arg "--no-deploy=traefik"\n')),Object(l.b)("p",null,"K3d by default installs Traefik as a load balancer, above command creates a k3d cluster without Traefik because we will use VKPR's NGINX Ingress Controller."),Object(l.b)("h3",{id:"setup-helm"},"Setup Helm"),Object(l.b)("p",null,"Before installation Helm needs to know the VKPR repository, run:"),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-shell"}),"# Add repo chart\nhelm repo add vertigo https://charts.vertigo.com.br\n\n# Update repo\nhelm repo update\n")),Object(l.b)("h3",{id:"installation-vkpr"},"Installation VKPR"),Object(l.b)("p",null,"For installation of VKPR need a values file. The values file below sets the installation of VKPR for just the NGNIX and app whoami. If you want to implement your installation there other guides in this section."),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-yaml",metastring:"title=values.yaml",title:"values.yaml"}),'ingress-nginx:\n  enabled: true\n\ningress:\n  enabled: true\n  annotations:\n    ingress.kubernetes.io/ssl-redirect: "false"\n  hosts:\n  - host: whoami.localdomain\n    paths: ["/"]\n')),Object(l.b)("p",null,"To install VKPR run:"),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-shell"}),"helm upgrade -i -f values.yaml vkpr vertigo/vkpr\n")),Object(l.b)("h3",{id:"access-whoami-app"},"Access whoami app"),Object(l.b)("p",null,"VKPR has a simple application to validate the installation. The application whoami prints operating system information and the HTTP request. To access the application, you must first obtain the external NGINX IP and add it to a domain in ",Object(l.b)("inlineCode",{parentName:"p"},"/etc/hosts")," (update ",Object(l.b)("inlineCode",{parentName:"p"},"LOAD_BALANCER_IP")," value), run:"),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-shell"}),"# Get external ip from nginx\nkubectl get service vkpr-ingress-nginx-controller\n\n# Edit hosts file\nsudo sh -c \"echo '<LOAD_BALANCER_IP> whoami.localdomain' >> /etc/hosts\"\n")),Object(l.b)("p",null,"Then go to the browser the ",Object(l.b)("inlineCode",{parentName:"p"},"http://whoami.localdomain"),"."),Object(l.b)("h2",{id:"destroy-environment"},"Destroy environment"),Object(l.b)("p",null,"After completing the tests you can uninstall VKPR and destroy the local Kubernetes cluster."),Object(l.b)("h3",{id:"uninstall-vkpr"},"Uninstall VKPR"),Object(l.b)("p",null,"To uninstall VKPR run:"),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-shell"}),"helm uninstall vkpr\n")),Object(l.b)("h3",{id:"destroy-cluster"},"Destroy cluster"),Object(l.b)("p",null,"To destroy the local cluster run:"),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-shell"}),"k3d cluster delete vkpr-local\n")))}u.isMDXComponent=!0},95:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return m}));var a=n(0),r=n.n(a);function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var c=r.a.createContext({}),u=function(e){var t=r.a.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=u(e.components);return r.a.createElement(c.Provider,{value:t},e.children)},b={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},d=r.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,l=e.originalType,i=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),p=u(n),d=a,m=p["".concat(i,".").concat(d)]||p[d]||b[d]||l;return n?r.a.createElement(m,o(o({ref:t},c),{},{components:n})):r.a.createElement(m,o({ref:t},c))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var l=n.length,i=new Array(l);i[0]=d;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o.mdxType="string"==typeof e?e:a,i[1]=o;for(var c=2;c<l;c++)i[c]=n[c];return r.a.createElement.apply(null,i)}return r.a.createElement.apply(null,n)}d.displayName="MDXCreateElement"}}]);